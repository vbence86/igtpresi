pgc=window.pgc||{},pgc.Game=pgc.Game||{},function(a,b){var c=b.$,d={},e={},f=gameName+"-currentState",g=window.touchCasinoBrandConf&&window.touchCasinoBrandConf.enableHeartbeat||!1,h=function(a,b){var c=function(a){return"function"==typeof a},d={"default":function(){return c(a)?a.apply(null,Array.prototype.slice(arguments)):void 0}};return function(){var a=Array.prototype.slice.call(arguments);return c(b)?b.apply(d,a):void 0}},i=function(){window.initialise&&(initialise.itHasBeenCalled?(listenToLastAnimation(),pgc.Game.ScratchController.startNewGame()):(initialise(a.ScratchZone),initialise.itHasBeenCalled=!0)),k(),a.updateBank(a.Server.Response.bank),a.updatePriceLabel(a.price),c(document.body).addClass("gameStarted"),switchSceneTo("game-scene")},j=function(){g&&a.heartbeatManager.start()},k=function(){g&&a.heartbeatManager.stop()},l=function(b){var c,d=pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.intro);if(a.getAudioEngine()&&a.getAudioEngine().version>1){if(c=a.getAudioEngine().getAudioSprite(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main)),c&&!c.hasTrack(d)&&(d+=["-",a.chosenTheme].join("")),c&&!c.hasTrack(d))return;setTimeout(function(){a.getAudioEngine().playSound(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main),d,function(){"function"==typeof b&&b()})},500)}},m=function(){a.playAmbientSound()};e.Init={enter:function(b,d,e,f){var g=f||{};a.Client.processResponse(g),initUserData(),initLocalisation(),initSelectionFlow();var h=c("#help-button-wrapper");h.addEventListener(DOMUtil.touchEvent,function(){c("#help-button").hasClass("disabled")||pgc.Game.StateMachine.loadinfo()}),j(),a.updateBank(a.Server.Response.bank)},leave:function(){}},e.Reset={enter:function(){},leave:function(){}},e.Unfinished={enter:function(){var b=a.UserData&&parseInt(a.UserData.getUserData("chosenTheme"))||1;c(document.body).addClass("NoIntroAnimations"),setChosenSkin(b),a.StateMachine.inGame()},leave:function(){i(),loadUnfinishedGameData(),setTimeout(function(){pgc.Game.audio&&pgc.Game.audio.audioEnabled&&m()},3e3)}},e.Purchase={enter:function(){var b="",d="   ",e=function(){var a=c("#purchase-ticket-price");pgc.Game.Server&&pgc.Game.Server.Response.price?a.innerHTML="<p>"+pgc.Game.multiCurrencyManager.formatAmount(pgc.Game.Server.Response.price,!1,!0,1)+",-</p>":(b+=".",d=d.substr(0,d.length-1),"...."===b&&(b="",d="   "),a.innerHTML="<p>"+d+b+",-</p>",setTimeout(e,1e3))};e(),a.updateBank(a.Server.Response.bank),switchSceneTo("purchase-scene"),c("body").removeClass("gameStarted"),c(document.body).removeClass("NoIntroAnimations");var f=c("#sceneFader"),g=c(".main-game-bar");f&&(f.removeClass("shown"),g&&g.removeClass("hideBehindFader"))},leave:function(b,c,d,e){if("Info"!==d){if(pgc.Game.isAudioEngineDelayedLoad())pgc.Game.preloadAudioMobileFallback();else try{pgc.Game.getAudioEngine().playSound(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main),pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.buy))}catch(f){}pgc.Game.updateAmbientLastEventTime()}return"Selection"==d||"Intro"==d?(a.Client.sendBuyMessage(function(){a.updateBank(a.Server.Response.bank),a.StateMachine.transition()}),StateMachine.ASYNC):void 0}},e.Selection={enter:function(){switchSceneTo("selection-scene")},leave:function(){resetSelectionFlow(),pgc.Game.updateAmbientLastEventTime()}},e.Intro={enter:function(){i(),l(function(){m()})},leave:function(){}},e.InGame={enter:function(){var b=c(".main-game-bar");c("#purchase-button")&&c("#purchase-button").removeClass("pressed"),b&&b.removeClass("hideBehindFader"),a.idleManager.listen(),a.updateBank(a.Server.Response.bank)},leave:function(b,c,d){a.idleManager.stop()}},e.Summary={enter:function(){setTimeout(function(){if(hasWin(a.ScratchZone)&&!hasInstantWin(a.ScratchZone)){pgc.Game.getAudioEngine().playSound(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main),pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.win));var b=new WinPopupTable;b.createContent(a.ScratchZone,a.multiCurrencyManager),PopupHelper.showPopup("win-popup",!0)}else hasInstantWin(a.ScratchZone)?PopupHelper.showPopup("bonuswin-popup",!0):PopupHelper.showPopup("nowin-popup",!0)},2e3)},leave:function(){a.particleSystem&&a.particleSystem.reset(),a.fadeAmbientSound(5)}},e.GameFinished={enter:function(){a.EndGamePopupConfirmed=!1,resetSavedGameData(),a.StateMachine.init()},leave:function(){}},e.Info={enter:function(){var b=a.chosenTheme||1;setChosenSkin(b),switchSceneTo("info-scene")},leave:function(){}},d.init={from:["none","GameFinished","result"],to:["Init","Reset"],before:function(){},after:function(){"result"==a.Server.Response.gameState?"Selection"===a.UserData.getUserData(f)?a.StateMachine.selection():a.StateMachine.unfinished():a.StateMachine.purchase()}},d.purchase={from:["none","GameFinished","Init","Reset"],to:"Purchase",before:function(){},after:function(){}},d.selection={from:["Purchase","Info","Init"],to:"Selection",before:function(){return a.hasSelectionScene()?void 0:(a.StateMachine.intro(),!1)},after:function(){}},d.intro={from:["Purchase","Selection"],to:"Intro",before:function(){},after:function(){}},d.unfinished={from:["Init"],to:"Unfinished",before:function(){},after:function(){}},d.inGame={from:["Intro","Unfinished","Summary"],to:"InGame",before:function(){},after:function(){}},d.summary={from:["InGame"],to:"Summary",before:function(){a.Client.sendFinishMessage(function(){a.StateMachine.finish(),j()})},after:function(){}},d.finish={from:["Summary"],to:"GameFinished",before:function(){return a.Client.isFinishMessageProcessed()&&a.EndGamePopupConfirmed?PopupHelper.isAllHidden()?void 0:(PopupHelper.hideAll(),!1):!1},after:function(){}},a.paytableDecorator=function(a,b){var c=document.createElement("div"),d=document.createElement("div");d.innerHTML=a,d.className="prize-name";var e=document.createElement("div");return e.innerHTML="1:"+b[a],e.className="prize-desc",c.className="payoutItem",c.appendChild(d),c.appendChild(e),c},d.loadinfo={from:["Purchase","Selection","InGame"],to:"Info",before:function(){var b={"{symbol:w}":'<span class="symbol WildSymbol"></span>',"{symbol:x}":'<span class="symbol WildSymbol2"></span>',"{symbol:y}":'<span class="symbol WildSymbol3"></span>'};writeText("infoPageTitle","info.page.title","Informajosn"),writeText("howToPlayItemTitle","info.howtoplay.title","Slik spiller du"),writeText("paytableItemTitle","info.paytable.title","Premieoversikt");var d,e,f,g=getLocalisedStringWithDefaultText("info.howtoscratch.title");"default"===userAgent.OS?(e=getLocalisedStringWithDefaultText("info.howtoplay.top.desktop")||getLocalisedStringWithDefaultText("info.howtoplay.top"),f=getLocalisedStringWithDefaultText("info.howtoplay.bottom.desktop"),d=e+"<h1 id='paytable-header'>"+g+"</h1>"+f):(e=getLocalisedStringWithDefaultText("info.howtoplay.top.mobile")||getLocalisedStringWithDefaultText("info.howtoplay.top"),f=getLocalisedStringWithDefaultText("info.howtoplay.bottom.mobile"),d=e+"<h1 id='paytable-header'>"+g+"</h1>"+f);for(var h in b)d=d.replace(new RegExp(h,"g"),b[h]);howtoplayContent.innerHTML=d;var i=c("#info-page-close-wrapper");i.addEventListener(DOMUtil.touchEvent,function(){pgc.Game.getAudioEngine().playSound(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main),pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.control)),"InGame"==a.StateMachine.previous?a.StateMachine.closeingameinfo():"Purchase"==a.StateMachine.previous?a.StateMachine.closepurchaseinfo():"Selection"==a.StateMachine.previous&&a.StateMachine.selection()},!1);var j=document.getElementById("payoutTable"),k='<div class="payoutItem title"><div >'+getLocalisedStringWithDefaultText("info.paytable.prizetitle","Premie")+"</div><div>"+getLocalisedStringWithDefaultText("info.paytable.oddstitle","Odds")+"</div>";k=k.replace("{prize.amount}","").replace("{odds}","Odds"),j.innerHTML=k;var l=a.Paytable||{},m=l&&l.payouts||{};if(m)for(var n in m){var o=a.paytableDecorator(n,m);o&&j.appendChild(o)}var p=c("#infopage-maths"),q=(pgc.Game.prizeInfo||{winningOdds:"1:4,17",prizeRatio:"57.51 %"},["<p>",getLocalisedStringWithDefaultText("maths.winning.odds","winning Probability")," : ",l.winningOdds,"</p>","<p>",getLocalisedStringWithDefaultText("maths.rtp","Prize ratio")," : ",l.prizeRatio,"</p>","<p>",getLocalisedStringWithDefaultText("maths.regulation","Regulated as eSkrapespill"),"</p>"]);p.innerHTML=q.join(""),pgc.Game.getAudioEngine().playSound(pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.main),pgc.Game.ScratchController.skinSelect(pgc.Game.audio.names.control))},after:function(){}},d.closepurchaseinfo={from:["Info"],to:["Purchase"],before:function(){},after:function(){}},d.closeingameinfo={from:"Info",to:["InGame"],before:function(){},after:function(){switchSceneTo("game-scene")}},a.setupGameStateMachine=function(){a.StateMachine=pgc.GameStateMachine.create({useBodyTag:!0,events:d,states:e}),a.StateMachine.error=function(){console.log([].slice.call(arguments))},a.StateMachine.onenterstate=h(a.StateMachine.onenterstate,function(b,c,d){this["default"](),a.UserData&&"none"!==c&&a.UserData.setUserData(f,d)})},a.state=function(a,b){var c=function(c){var d=b[c];return d?e[a][c]?h(e[a][c],d):d:e[a][c]?e[a][c]:function(){}};if(!a||!b)throw"Invalid parameter has been passed!";e[a]?e[a]={enter:c("enter"),leave:c("leave")}:e[a]=b},a.event=function(a,b){var c=function(c){var e=b[c]||function(){};return d[a][c]?h(d[a][c],e):e};if(!a||!b||!b.to)throw"Invalid parameter has been passed!";d[a]?d[a]={before:c("before"),after:c("after"),to:b.to||"UnregisteredState",from:b.from||"*"}:d[a]=b}}(pgc.Game,PGCUniverse.PGCToolkit);